# EmotionQuant 技术债登记表（Spiral 版）

**最后更新**: 2026-02-17  
**版本**: v1.12  
**范围**: S0-S6

---

## 分级标准

| 优先级 | 定义 | 处理时限 |
|---|---|---|
| P0 | 阻断实现或造成错误决策 | 立即 |
| P1 | 影响核心闭环质量 | 当圈或下一圈 |
| P2 | 影响效率/可维护性 | 2-3 圈内 |
| P3 | 优化项 | 视资源安排 |

---

## 当前债务清单

| ID | 问题 | 优先级 | 影响 | 计划处理圈 | 状态 |
|---|---|---|---|---|---|
| TD-S0-002 | Validation 虽已补齐因子/权重验证语义，但生产级真实收益口径与统计校准仍待完成 | P2 | 影响 S3 回测与实盘前解释力一致性 | S3 | ⏳ 待处理 |
| TD-S0-004 | 回测基线实现未落地（仅选型文档） | P1 | S3 无法闭环 | S3 | ⏳ 待处理 |
| TD-S0-005 | 仓库内仍有部分 `Phase` 历史措辞（设计参考文档） | P2 | 容易带回线性心智 | S0-S2 | ⏳ 待处理 |
| TD-S0-006 | S0c 行业快照暂为全市场聚合，未接入 SW 行业映射聚合 | P1 | IRS 输入粒度不足，影响 S3 回测解释力 | S3 | ⏳ 待处理 |
| TD-S1-007 | MSS 当前采用固定阈值（30/45/60/75），未实现自适应分位阈值 | P2 | 极端行情下周期判定稳健性不足 | S3 | ⏳ 待处理 |
| TD-S1-008 | S1b 探针当前以 `mss_temperature` 前后变化代替收益序列，统计解释力有限 | P2 | `top_bottom_spread_5d` 对真实可交易性代表不足 | S3 | ⏳ 待处理 |
| TD-GOV-012 | `DESIGN_TRACE` 当前仅覆盖 S2c 关键模块，尚未覆盖全仓核心代码 | P2 | 仍可能存在“实现无设计溯源标记”的盲区 | S2c-S3 | ⏳ 待处理 |
| TD-S3A-011 | ENH-10 的分批下载/断点续传/多线程能力尚未实现 | P1 | S3 历史数据准备效率与恢复能力不可验证，影响回测迭代节奏 | S3a | ⏳ 待处理 |

---

## 已清偿

| ID | 问题 | 完成时间 | 说明 |
|---|---|---|---|
| TD-S0-001 | 尚未形成 S0 可运行最小闭环（命令+测试+产物） | 2026-02-15 | S0a/S0b/S0c 已完成 run/test/artifact/review/sync，6A 证据归档至 `Governance/specs/spiral-s0a`、`Governance/specs/spiral-s0b`、`Governance/specs/spiral-s0c` |
| TD-S0-003 | 权重验证模块仅设计未实现 | 2026-02-17 | S2c 已在 `src/algorithms/validation/pipeline.py` 落地 Walk-Forward 权重验证与 Gate 决策，并由 `test_weight_validation_walk_forward_contract.py` 覆盖 |
| TD-S2-009 | IRS/PAS 当前使用最小启发式评分，未接入完整行业映射与收益校准 | 2026-02-17 | S2c 已完成 IRS/PAS full 语义实现与合同测试；剩余行业粒度问题继续由 `TD-S0-006` 跟踪 |
| TD-S2-010 | S2c 已接入 `validation_weight_plan` 桥接硬门禁，但候选权重生成与 Walk-Forward 选优尚未实现 | 2026-02-17 | 候选权重评估与 Walk-Forward 选优已落地，桥接与语义回归测试通过 |
| TD-GOV-008 | contracts/governance 检查未进入任务模板门禁 | 2026-02-14 | 已在 `SPIRAL-TASK-TEMPLATE.md` 增加 S2+/契约变更场景检查项 |
| TD-GOV-013 | S2c 同日 PASS/FAIL 证据冲突（正式证据与调试证据混写） | 2026-02-17 | 已引入 `evidence_lane`（release/debug）隔离并新增 `scripts/quality/sync_s2c_release_artifacts.py` 前置校验，正式证据统一为 release |
| TD-GOV-007 | 执行链路 `contract_version` 兼容口径缺失 | 2026-02-14 | 已统一为 `nc-v1` 并同步到 CP-05/06/07/10 与主控路线 |
| TD-GOV-006 | PAS 与执行层 `risk_reward_ratio` 门槛漂移 | 2026-02-14 | 已统一为执行门槛 `risk_reward_ratio >= 1.0`，`<1.0` 过滤 |
| TD-GOV-005 | Spiral 文档同步负担过重 | 2026-02-07 | 已改为最小同步 5 项，CP 文档仅在契约变化时更新 |
| TD-GOV-001 | 路线图缺少 I/O/边界/错误处理 | 2026-02-07 | 已在 ROADMAP 能力包中补齐 |
| TD-GOV-002 | “零技术指标”口径与实践冲突 | 2026-02-07 | 已修订为“单指标不得独立决策” |
| TD-GOV-003 | DuckDB 按年分库为默认策略 | 2026-02-07 | 已改为单库优先、阈值触发分库 |
| TD-GOV-004 | 回测引擎单选写死 | 2026-02-07 | 已改为接口优先、可替换实现 |

---

## 备注

- 技术债必须在每圈 `final.md` 中复核，禁止“静默积压”。
- P0/P1 债务必须给出明确圈号，不允许无限顺延。

---

## 版本历史

| 日期 | 版本 | 变更内容 |
|---|---|---|
| 2026-02-17 | v1.12 | 清偿 TD-GOV-013：完成 S2c 证据冲突清障，新增 release/debug 证据隔离与 release 同步前置校验 |
| 2026-02-17 | v1.11 | 清偿 TD-S0-003/TD-S2-009/TD-S2-010；TD-S0-002 调整为“生产级统计口径校准待 S3” |
| 2026-02-17 | v1.10 | 新增 TD-GOV-012：设计溯源标记目前仅覆盖 S2c 关键模块，需继续扩展到全仓核心代码 |
| 2026-02-17 | v1.9 | 更新 TD-S2-010：从“未接入桥接”调整为“桥接已落地、候选权重选优待实现”，计划处理圈前移至 S2c |
| 2026-02-16 | v1.8 | 启动下一圈前补录 TD-S3A-011（ENH-10 能力尚未实现），计划处理圈锁定 S3a |
| 2026-02-15 | v1.7 | S2b 收口复核：将 S2 阶段遗留债务统一推进到 S3；新增 TD-S2-010（候选权重未接入） |
| 2026-02-15 | v1.6 | S2a 收口复核：TD-S0-002 调整为“最小 Gate 已落地，完整验证待 S2b”；新增 TD-S2-009（IRS/PAS 评分校准债务） |
| 2026-02-15 | v1.5 | S1b 收口复核：TD-S0-006/TD-S1-007 处理圈推进至 S2a；新增 TD-S1-008（探针收益口径债务） |
| 2026-02-15 | v1.4 | S1a 收口复核：TD-S0-002 处理圈调整为 S2a；新增 TD-S1-007（MSS 自适应阈值债务） |
| 2026-02-15 | v1.3 | 新增 TD-S0-006（S0c 行业快照粒度债务）；TD-S0-001 清偿范围扩展至 S0c |
| 2026-02-15 | v1.2 | 清偿 TD-S0-001：S0a/S0b 闭环与 6A 证据链补齐 |
| 2026-02-14 | v1.1 | 新增并清偿 TD-GOV-006/007/008（RR 门槛漂移、contract_version 兼容口径、contracts/governance 模板门禁） |
| 2026-02-07 | v1.0 | 切换到 Spiral 技术债模型，重建债务清单 |
