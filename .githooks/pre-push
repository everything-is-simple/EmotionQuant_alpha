#!/usr/bin/env sh
set -e

HOOK_DIR="$(CDPATH= cd -- "$(dirname -- "$0")" && pwd)"
REPO_ROOT="$(CDPATH= cd -- "$HOOK_DIR/.." && pwd)"
SCRIPT_PATH="$REPO_ROOT/scripts/hooks/pre_push.py"
export PYTHONUTF8="${PYTHONUTF8:-1}"
export PYTHONIOENCODING="${PYTHONIOENCODING:-utf-8}"

if command -v python >/dev/null 2>&1; then
  python -X utf8 "$SCRIPT_PATH" "$@"
elif command -v py >/dev/null 2>&1; then
  py -3 -X utf8 "$SCRIPT_PATH" "$@"
else
  echo "[pre-push] python runtime not found"
  exit 1
fi
